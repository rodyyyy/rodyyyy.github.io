---
layout: post
author: Chris Rody
title: mybatis的简单记录
---

mybatis简要记录

## mybatis宝典

## 1，mybatis执行流程图

![mybatis](https://github.com/rodyyyy/rodyyyy.github.io/raw/master/images/mybatis流程1.png)

![mybaa](https://github.com/rodyyyy/rodyyyy.github.io/raw/master/images/mybatis流程2.png)

## 2，具体简单代码

``` java
//创建SqlSessionFactoryBuilder对象
		SqlSessionFactoryBuilder ssb=new SqlSessionFactoryBuilder();
		//创建核心配置文件的输入流
		InputStream inputStream = Resources.getResourceAsStream("SqlMapConfig.xml");
		//通过输入流创建SqlSessionFactory对象
		SqlSessionFactory sqlSessionFactory = ssb.build(inputStream);
		//通过openSession（），创建SqlSession对象
		SqlSession sqlSession = sqlSessionFactory.openSession();
		//执行查询
		User user = sqlSession.selectOne("getUserById",1);
		//输出结果
		System.out.println(user);
		//释放资源
		sqlSession.close();
```

## 3,流程原理阐述

>SqlSessionFactoryBuilder通过类名就可以看出这个类的主要作用就是创建一个SqlSessionFactory
>
>通过输入mybatis配置文件的字节流或者字符流，生成XMLConfigBuilder
>
>XMLConfigBuilder创建一个Configuration，Configuration这个类中包含了mybatis的配置的一切信
>
>mybatis进行的所有操作都需要根据Configuration中的信息来进行

## 4，xml细节

**a,属性名符号，是`而不是'**

```xml
<insert id="insertUserUuid" parameterType="com.rody.mybatis.pojo.User" useGeneratedKeys="true" keyProperty="id">
	<selectKey keyProperty="uuid2" resultType="String" order="BEFORE">
		SELECT UUID()
	</selectKey>    
		INSERT INTO `mybatis`.`user`
	(`username`,`birthday`,`sex`,`address`,`uuid2`)
    <!-- 这里的属性名符号，是`而不是' -->
	VALUES (#{username},#{birthday},#{sex},#{address},#{uuid2})
	</insert>
```

**b,在xml mapper中的sql语句，不能用逗号**

```xml
<update id="updateUserInfo" parameterType="com.rody.mybatis.pojo.User" >
	     update `mybatis`.`user`
	     set 
         username=#{username}
	     where id=#{id}
	</update>
```

**c,xml的delete操作只能删除数据库中的最后一行**

![01patch](https://github.com/rodyyyy/rodyyyy.github.io/raw/master/images/delete.png)

![01patch](https://github.com/rodyyyy/rodyyyy.github.io/raw/master/images/delete1.png)

**d,config和包目录下具有相同的xml文件件**

>若包下有相同名称的类文件，则对应测试类先匹配的是包下的xml文件